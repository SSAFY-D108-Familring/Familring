pipeline {
    agent any

    stages {
        stage('Build Core Services') {
            steps {
                script {
                    def coreServices = ["config-service", "discovery-service", "api-gateway"]

                    for (service in coreServices) {
                        // 각 core 서비스 디렉토리로 이동하여 빌드
                        dir(service) {
                            // 각 서비스별 Jenkinsfile 을 실행하거나 빌드 스크립트를 직접 호출
                            build job: "${service}-build-job"  // Jenkins 에 core 서비스별 job 이 사전에 정의되어 있어야 함
                        }
                    }
                }
            }
        }

        stage('Build Remaining Services') {
            steps {
                script {
                    def otherServices = ["user-service", "calendar-service", "common-service", "family-service", "interest-service", "notification-service", "question-service", "timecapsule-service", "album-service"]

                    for (service in otherServices) {
                        // 각 나머지 서비스 디렉토리로 이동하여 빌드
                        dir(service) {
                            build job: "${service}-build-job"  // Jenkins 에 나머지 서비스별 job 이 사전에 정의되어 있어야 함
                        }
                    }
                }
            }
        }
    }
}
